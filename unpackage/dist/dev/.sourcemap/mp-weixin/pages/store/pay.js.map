{"version":3,"sources":["uni-app:///main.js","webpack:///C:/project/snack/snack/pages/store/pay.vue?7918","webpack:///C:/project/snack/snack/pages/store/pay.vue?30d5","webpack:///C:/project/snack/snack/pages/store/pay.vue?946d","webpack:///C:/project/snack/snack/pages/store/pay.vue?de5e","uni-app:///pages/store/pay.vue","webpack:///C:/project/snack/snack/pages/store/pay.vue?7be2"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","uIcon","uLine","uInput","uPopup","uSubsection","uToast","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","g0","_self","_c","Object","keys","address_detail","length","g1","m0","Number","enough_free_dyrmbs","g2","coupon","g3","$mp","data","assign","$root","recyclableRender","staticRenderFns","_withStripped","couponShow","shop_name","delivery_rmbs","cart","couponlist","name","current","activeCoupon","activeCouponNum","model","goods_ids","goods_nums","addressid","couponid","remark","props","index","computed","numsum","total","amount","onLoad","methods","addressdefault","mycoupon","addressClick","uni","url","animationType","animationDuration","chooseAddress","goPayMoney","title","duration","toPay","provider","timeStamp","nonceStr","package","signType","paySign","success","fail","couponClick","couponTabChange","use"],"mappings":"0IAAA,MAGA,aACA,YAFAA,EAAGC,kCAAoCC,EAGvCC,EAAWC,a,gFCLX,oIACIC,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,sBACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IACEA,EAAa,CACXC,MAAO,WACL,OAAO,iEAITC,MAAO,WACL,OAAO,iEAITC,OAAQ,WACN,OAAO,uGAITC,OAAQ,WACN,OAAO,mEAITC,YAAa,WACX,OAAO,6EAITC,OAAQ,WACN,OAAO,oEAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eAETC,GADKJ,EAAIK,MAAMC,GACVC,OAAOC,KAAKR,EAAIS,gBAAgBC,QACrCC,EAAKJ,OAAOC,KAAKR,EAAIS,gBAAgBC,OACrCE,EAAKC,OAAOb,EAAIc,oBAChBC,EAAKf,EAAIgB,OAAON,OAChBO,EAAKjB,EAAIgB,OAAON,OACpBV,EAAIkB,IAAIC,KAAOZ,OAAOa,OACpB,GACA,CACEC,MAAO,CACLjB,GAAIA,EACJO,GAAIA,EACJC,GAAIA,EACJG,GAAIA,EACJE,GAAIA,MAKRK,GAAmB,EACnBC,EAAkB,GACtBxB,EAAOyB,eAAgB,G,iCC3EvB,yHAAqxB,eAAG,G,0ICiIxxB,GADA,MACA,OAGA,6sBAEA,CACArC,YACA6B,UAEAG,gBACA,OACAM,cACAC,aACAC,gBACAb,qBAEAc,QAEAC,aACAC,eAEAC,UACAf,UACAgB,qBACAC,mBACAC,OACAC,aACAC,cACAC,YACAC,WACAC,WAEA9B,oBAGA+B,OACAC,eAEAC,iBACA,oDACAC,kBACA,+DAEAC,iBACA,qEAEA,iCACAA,iCAGA,sCAOA,OANA,MACAA,+BAEA,MACAA,KAEA,GAEAC,kBACA,yEAGAC,mBACA,sBACA,mCACA,6CACA,2BACA,uCAEA,SACA,KACA,2BACAX,mBACAC,oBAEA,kCACA,mCAEA,sBACA,iBAEAW,SACAC,0BAAA,WAEA,kEACA,cACA,gBACA,mBACA,mCAIAC,oBAAA,WACApD,4BAEA,oFACA,YACA,+BACA,iCAKAqD,wBACAC,cACAC,uBACAC,uBACAC,yBAIAC,0BACA1D,eACA,sBACA,kCAEA2D,sBAAA,WAEA,GADA3D,wBACA,wBAKA,OAJA,wBACA4D,cACAC,gBAEA,EAQA,oEACA,UACA,mBAEA,qBACAD,gBACAC,mBAMAC,kBAAA,WACA,oEAEA,cAEA,gBACAR,kBACAS,iBACAC,sBACAC,oBACAC,kBACAC,oBACAC,kBACAC,oBACArE,0CAEAsD,aACAC,iCAGAe,iBACAtE,+CAIAsD,aACAC,gCAEA,qBACAK,gBACAC,mBAKAU,uBACA,uBACA,qBAGAC,4BACA,gBAEAC,gBAEA,kCAKA,OAJA,wBACAb,mBACAC,gBAEA,EAGA,6BACA,4BAEA,yBAEA,sBAGA,c,6DC9UA,yHAA0mC,eAAG,G","file":"pages/store/pay.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/store/pay.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./pay.vue?vue&type=template&id=15db955e&\"\nvar renderjs\nimport script from \"./pay.vue?vue&type=script&lang=js&\"\nexport * from \"./pay.vue?vue&type=script&lang=js&\"\nimport style0 from \"./pay.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/store/pay.vue\"\nexport default component.exports","export * from \"-!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=template&id=15db955e&\"","var components\ntry {\n  components = {\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-icon/u-icon\" */ \"@/uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uLine: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-line/u-line\" */ \"@/uview-ui/components/u-line/u-line.vue\"\n      )\n    },\n    uInput: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-input/u-input\" */ \"@/uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    uPopup: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-popup/u-popup\" */ \"@/uview-ui/components/u-popup/u-popup.vue\"\n      )\n    },\n    uSubsection: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-subsection/u-subsection\" */ \"@/uview-ui/components/u-subsection/u-subsection.vue\"\n      )\n    },\n    uToast: function () {\n      return import(\n        /* webpackChunkName: \"uview-ui/components/u-toast/u-toast\" */ \"@/uview-ui/components/u-toast/u-toast.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = Object.keys(_vm.address_detail).length\n  var g1 = Object.keys(_vm.address_detail).length\n  var m0 = Number(_vm.enough_free_dyrmbs)\n  var g2 = _vm.coupon.length\n  var g3 = _vm.coupon.length\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        m0: m0,\n        g2: g2,\n        g3: g3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"padding-30 margin-center padding-bottom-150\">\r\n\r\n\t\t<!-- 配送地址 -->\r\n\t\t<view v-if=\"Object.keys(address_detail).length == 0\" class=\"bg-color-white padding-20 padding-top-50 padding-bottom-50 border-radius-15\">\r\n\t\t\t<view class=\"font30\" @tap=\"addressClick\">\r\n\t\t\t\t<label>请选择收货地址</label>\r\n\t\t\t\t<view style=\"float: right;\">\r\n\t\t\t\t\t<u-icon name=\"arrow-right\" color=\"#c1c1c1\" size=\"28\"></u-icon>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view v-if=\"Object.keys(address_detail).length > 0\" class=\"bg-color-white padding-20 border-radius-15\">\r\n\t\t\t<view class=\"font34 font-bold\" @tap=\"addressClick\">\r\n\t\t\t\t<label>\r\n\t\t\t\t\t<u-icon name=\"map\" color=\"#ef5f1b\" size=\"35\"></u-icon>\r\n\t\t\t\t\t<text class=\"padding-left-20\">{{address_detail.address}}</text>\r\n\t\t\t\t</label>\r\n\t\t\t\t<view style=\"float: right;\">\r\n\t\t\t\t\t<u-icon name=\"arrow-right\" color=\"#c1c1c1\" size=\"28\"></u-icon>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"margin-top-10 padding-left-50\">{{address_detail.real_name}} {{address_detail.phone}}</view>\r\n\t\t</view>\r\n\t\t<!-- 商品清单 -->\r\n\t\t<view class=\"bg-color-white padding-20 border-radius-15 margin-top-20\">\r\n\t\t\t<view class=\"padding-top-20 padding-bottom-30\">\r\n\t\t\t\t<u-icon name=\"dianpu\" custom-prefix=\"custom-icon\" color=\"#ef5f1b\" size=\"34\"></u-icon>\r\n\t\t\t\t<text class=\"margin-left-10 gray3\">{{shop_name}}</text>\r\n\t\t\t</view>\r\n\t\t\t<u-line color=\"#f3f3f3\"/>\r\n\t\t\t<view class=\"d-row d-jc-between padding-10 padding-bottom-20\" v-for=\"(item,index) in cart\"\r\n\t\t\t\t:key=\"index\">\r\n\t\t\t\t<view class=\"d-row\">\r\n\t\t\t\t\t<view class=\"d-clo d-ai-centen\">\r\n\t\t\t\t\t\t<image style=\"width: 100rpx;height: 100rpx;\" :src=\"item.goods_pic\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"d-clo d-jc-between padding-left-10\">\r\n\t\t\t\t\t\t<view class=\"font28 font-bold\">{{item.goods_name}}</view>\r\n\t\t\t\t\t\t<view class=\"font22 gray4\">{{item.goods_desc}}</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"flex-1 text-right\">\r\n\t\t\t\t\t<text>x{{item.number}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"text-right\" style=\"width: 130rpx;\">\r\n\t\t\t\t\t<text class=\"font-bold\">¥{{item.price}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<u-line color=\"#f3f3f3\" />\r\n\t\t\t<view class=\"d-row d-jc-between padding-10 padding-bottom-20 padding-top-20\">\r\n\t\t\t\t<view class=\"font-bold font28\">配送费</view>\r\n\t\t\t\t<view class=\"font-bold\" v-if=\"total > Number(enough_free_dyrmbs)\">免配送费</view>\r\n\t\t\t\t<view v-else>¥{{delivery_rmbs}}</view>\r\n\t\t\t</view>\r\n\t\t\t<view>\r\n\t\t\t\t<view @tap=\"couponClick\" class=\"u-cell u-border-bottom u-col-center\" style=\"background-color: transparent;\">\r\n\t\t\t\t\t<u-icon name=\"quan\" custom-prefix=\"custom-icon\" color=\"#ef5f1b\" size=\"38\"></u-icon>\r\n\t\t\t\t\t<view class=\"u-cell_title\" style=\"width: auto;\">优惠券</view>\r\n\t\t\t\t\t<view class=\"u-cell__value\">\r\n\t\t\t\t\t\t<text v-if=\"coupon.length > 0\">{{activeCoupon}}</text>\r\n\t\t\t\t\t\t<text v-if=\"coupon.length == 0\">暂无可用优惠券</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<u-icon name=\"arrow-right\" color=\"#909399\" size=\"26\"></u-icon>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"d-row d-jc-between d-ai-centen padding-10 padding-top-30\">\r\n\t\t\t\t<view class=\"gray3\"> \r\n\t\t\t\t\r\n\t\t\t\t</view>\r\n\t\t\t\t<view>共{{ numsum }}个商品，小计：<label class=\"font-bold font40\">¥ {{ total }}</label></view>\r\n\t\t\t</view>\r\n\r\n\t\t</view>\r\n\t\t<!-- 支付方式 -->\r\n\t\t<view class=\"bg-color-white padding-20 border-radius-15 margin-top-20 font30\">\r\n\t\t\t<view class=\"d-row d-jc-between padding-top-20 padding-bottom-30\" style=\"border-bottom: 1rpx solid #F7F7F7;\">\r\n\t\t\t\t<view>支付方式</view>\r\n\t\t\t\t<view>微信支付</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"d-row d-jc-between padding-top-20 padding-bottom-20\">\r\n\t\t\t\t<view>备注</view>\r\n\t\t\t\t<view>\r\n\t\t\t\t\t<!-- <u-icon margin-left=\"10\" name=\"arrow-right\" color=\"#c1c1c1\" size=\"28\"></u-icon> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view>\r\n\t\t\t\t<u-input v-model=\"model.remark\" type=\"textarea\" border=\"true\" border-color=\"#f1f1f1\" height=\"200\" auto-height=\"true\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<!-- 去支付 -->\r\n\t\t<view class=\"pay\">\r\n\t\t\t<view style=\"margin:0 auto;\" class=\"width100 d-row d-jc-between\">\r\n\t\t\t\t<view class=\"d-row d-jc-start d-ai-centen\" style=\"padding-left: 10rpx;\">\r\n\t\t\t\t\t<view class=\"d-ai-centen padding-left-10\">\r\n\t\t\t\t\t\t<text style=\"vertical-align: middle;\">合计</text>\r\n\t\t\t\t\t\t<text class=\"padding-left-10 text-bolder\" style=\"vertical-align: middle;color: #ff6634;font-size: 37rpx;\">¥ {{ total }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"go gray4\">\r\n\t\t\t\t\t<view class=\"go gray4 font28 colorWhiteBgBlue\" @tap=\"goPayMoney\">\r\n\t\t\t\t\t\t提交订单\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<u-popup v-model=\"couponShow\" mode=\"bottom\">\r\n\t\t\t<view style=\"height: 60vh;position: relative;\">\r\n\t\t\t\t<view class=\"padding-top-20 padding-bottom-20\" style=\"background-color: #eeeeef; position: sticky; top: 0; z-index: 3;\">\r\n\t\t\t\t\t<u-subsection :list=\"couponlist\" :current=\"current\" active-color=\"#ef5f1b\" :animation=\"true\" @change=\"couponTabChange\"></u-subsection>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"padding-left-20 padding-right-20 padding-bottom-50\">\r\n\t\t\t\t\t<coupon v-for=\"(item, index) in coupon\" :key=\"index\" v-bind:item=\"item\" @use=\"use\" theme=\"#ff6c00\" color=\"#ffffff\" solid=\"#ff6c00\"></coupon>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</u-popup>\r\n\r\n\t\t<u-toast ref=\"uToast\" />\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport coupon from '@/components/coolc-coupon/coolc-coupon';\r\n\timport { post, get, wx_pay, showToast } from '../../tools/utils.js'\r\n\timport {\r\n\t\tmapState,\r\n\t\tmapMutations\r\n\t} from 'vuex'\r\n\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tcoupon\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcouponShow: false,\r\n\t\t\t\tshop_name: '',\r\n\t\t\t\tdelivery_rmbs:0, // 运费\r\n\t\t\t\tenough_free_dyrmbs:0, // 满多少免运费\r\n\t\t\t\t \r\n\t\t\t\tcart: [],\r\n\t\t\t\t\r\n\t\t\t\tcouponlist: [{\r\n\t\t\t\t\tname: '可用优惠券'\r\n\t\t\t\t}],\r\n\t\t\t\tcurrent: 0,\r\n\t\t\t\tcoupon:[],\r\n\t\t\t\tactiveCoupon:'选择优惠券',\r\n\t\t\t\tactiveCouponNum:'',\r\n\t\t\t\tmodel:{\r\n\t\t\t\t\tgoods_ids:'',\r\n\t\t\t\t\tgoods_nums:'',\r\n\t\t\t\t\taddressid:0,\r\n\t\t\t\t\tcouponid:0,\r\n\t\t\t\t\tremark:''\r\n\t\t\t\t},\r\n\t\t\t\taddress_detail:{}\r\n\t\t\t}\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\tindex: 'index'\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['orderType', 'address', 'store']),\r\n\t\t\tnumsum() {\r\n\t\t\t\treturn this.cart.reduce((acc, cur) => acc + cur.number, 0)\r\n\t\t\t},\r\n\t\t\ttotal() {\r\n\t\t\t\tlet total = this.cart.reduce((acc, cur) => acc + cur.number * cur.price, 0)\r\n\t\t\t\t// 判断是否选择优惠券\r\n\t\t\t\tif(Number(this.activeCouponNum) > 0) {\r\n\t\t\t\t\ttotal = total - Number(this.activeCouponNum)\r\n\t\t\t\t}\r\n\t\t\t\t// 判断金额是否符合免运费\r\n\t\t\t\tlet enough_free_dyrmbs_fmt = Number(this.enough_free_dyrmbs)\r\n\t\t\t\tif(total < enough_free_dyrmbs_fmt) {\r\n\t\t\t\t\ttotal = total + Number(this.delivery_rmbs)\r\n\t\t\t\t}\r\n\t\t\t\tif(total < 0) {\r\n\t\t\t\t\ttotal = 0\r\n\t\t\t\t}\r\n\t\t\t\treturn total\r\n\t\t\t},\r\n\t\t\tamount() {\r\n\t\t\t\treturn this.cart.reduce((acc, cur) => acc + cur.number * cur.price, 0)\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\tthis.shop_name = option.name\r\n\t\t\tthis.delivery_rmbs = option.delivery_rmbs\r\n\t\t\tthis.enough_free_dyrmbs = option.enough_free_dyrmbs\r\n\t\t\tthis.companyid = option.companyid\r\n\t\t\tthis.cart = uni.getStorageSync('cart') || []\r\n\t\t\t\r\n\t\t\tlet goods_ids = []\r\n\t\t\tlet goods_nums = []\r\n\t\t\tthis.cart.map((item)=>{\r\n\t\t\t\tgoods_ids.push(item.goods_id)\r\n\t\t\t\tgoods_nums.push(item.number)\r\n\t\t\t})\r\n\t\t\tthis.model.goods_ids = goods_ids.toString()\r\n\t\t\tthis.model.goods_nums = goods_nums.toString()\r\n\t\t\t\r\n\t\t\tthis.addressdefault()\r\n\t\t\tthis.mycoupon()\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\taddressdefault(){\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tthis.$store.dispatch('shops/addressdefault',{}).then((res) => {\r\n\t\t\t\t\tif(res.code == 0) {\r\n\t\t\t\t\t\tlet data = res.message;\r\n\t\t\t\t\t\tthis.address_detail = data\r\n\t\t\t\t\t\tthis.model.addressid = data.addressid\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tmycoupon() {\r\n\t\t\t\tconsole.log(this.companyid)\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tthis.$store.dispatch('shops/mycoupon',{'companyid':this.companyid}).then((res) => {\r\n\t\t\t\t\tif(res.code == 0) {\r\n\t\t\t\t\t\tthis.coupon = res.message.coupon_list\r\n\t\t\t\t\t\tthis.maxpage = res.message.maxpage\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t\r\n\t\t\taddressClick() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: './address?type=1',\r\n\t\t\t\t\tanimationType: 'pop-in',\r\n\t\t\t\t\tanimationDuration: 2000\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 渲染地址\r\n\t\t\tchooseAddress(data){\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t\tthis.address_detail = data\r\n\t\t\t\tthis.model.addressid = data.addressid\r\n\t\t\t},\r\n\t\t\tgoPayMoney() {\r\n\t\t\t\tconsole.log(this.model)\r\n\t\t\t\tif(this.model.addressid == 0) {\r\n\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\ttitle: '请选择地址',\r\n\t\t\t\t\t\tduration:1000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t// uni.switchTab({\r\n\t\t\t\t// \turl: '../order/order-list',\r\n\t\t\t\t// \tanimationType: 'pop-in',\r\n\t\t\t\t// \tanimationDuration: 2000\r\n\t\t\t\t// })\r\n\t\t\t\t\r\n\t\t\t\tthis.$store.dispatch('shops/addorder',this.model).then((res) => {\r\n\t\t\t\t\tif(res.code == 0) {\r\n\t\t\t\t\t\tthis.toPay(res.message)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\tduration:1000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\ttoPay(token){\r\n\t\t\t\tthis.$store.dispatch('shops/pay',{'order_token':token}).then((res) => {\r\n\t\t\t\t\r\n\t\t\t\t\tif(res.code == 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tvar data = res.message;\r\n\t\t\t\t\t\tuni.requestPayment({\r\n\t\t\t\t\t\t    provider: 'wxpay',\r\n\t\t\t\t\t\t    timeStamp: data.timeStamp,\r\n\t\t\t\t\t\t    nonceStr: data.nonceStr,\r\n\t\t\t\t\t\t    package: data.package,\r\n\t\t\t\t\t\t    signType: data.signType,\r\n\t\t\t\t\t\t    paySign: data.paySign,\r\n\t\t\t\t\t\t    success: function (res) {\r\n\t\t\t\t\t\t        console.log('success:' + JSON.stringify(res));\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\t\t\turl:'/pages/order/order-list'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t    fail: function (err) {\r\n\t\t\t\t\t\t        console.log('fail:' + JSON.stringify(err));\r\n\t\t\t\t\t\t    }\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\turl:'/pages/order/order-list'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\t\ttitle: res.message,\r\n\t\t\t\t\t\t\tduration:1000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tcouponClick() {\r\n\t\t\t\tif(this.coupon.length > 0) {\r\n\t\t\t\t\tthis.couponShow = true\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcouponTabChange(index) {\r\n\t\t\t\tthis.current = index;\r\n\t\t\t},\r\n\t\t\tuse(data) {\r\n\r\n\t\t\t\tif(this.total < Number(data.need_rmbs)){\r\n\t\t\t\t\tthis.$refs.uToast.show({\r\n\t\t\t\t\t\ttitle: '未满足优惠券使用要求',\r\n\t\t\t\t\t\tduration:1000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.activeCoupon = '￥'+data.rmbs\r\n\t\t\t\tthis.activeCouponNum = data.rmbs\r\n\t\t\t\t\r\n\t\t\t\tthis.model.couponid = data.id\r\n\t\t\t\t\r\n\t\t\t\tthis.couponShow = false\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\tpage {\r\n\t\tbackground-color: #f7f7f7;\r\n\t}\r\n\r\n\t.pay {\r\n\t\tbackground-color: #ffffff;\r\n\t\twidth: 100%;\r\n\t\theight: 105rpx;\r\n\t\tmargin: 0 auto;\r\n\t\t\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t\tz-index: 1000;\r\n\t\t\r\n\t\tbox-shadow: 0px -1px 3px #ececec;\r\n\t}\r\n\r\n\t.go {\r\n\t\twidth: 240rpx;\r\n\t\theight: 105rpx;\r\n\t\tline-height: 105rpx;\r\n\t\tbackground: linear-gradient(to right,#fbab7c,#de2406);\r\n\t\tcolor: #cecece !important;\r\n\t\ttext-align: center;\r\n\t\t\r\n\t}\r\n\r\n\t.colorWhiteBgBlue {\r\n\t\tbackground-color: #007AFF !important;\r\n\t\tcolor: #FFFFFF !important;\r\n\t}\r\n\r\n\t.u-cell {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t\tbox-sizing: border-box;\r\n\t\twidth: 100%;\r\n\t\tpadding: 26rpx 0;\r\n\t\tfont-size: 22rpx;\r\n\t\tline-height: 45rpx;\r\n\t\t\r\n\t\tbackground-color: #fff;\r\n\t\ttext-align: left;\r\n\t}\r\n\r\n\t.u-cell_title {\r\n\t\tpadding-left: 15rpx;\r\n\t\tfont-size: 28rpx;\r\n\t}\r\n\r\n\t.u-cell__value {\r\n\t\tflex: 1;\r\n\t\toverflow: hidden;\r\n\t\ttext-align: right;\r\n\t\tvertical-align: middle;\r\n\t\tcolor: #909399;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n\r\n</style>\n","import mod from \"-!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../hbuildx/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./pay.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}